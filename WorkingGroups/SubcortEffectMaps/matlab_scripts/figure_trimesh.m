function figure_trimesh(surf,value, roi_id, cmap, color_map_lookup, fig_finish)
%
% function figure_trimesh(surf,value, cmap)
% 
% Color mesh vertices of "surf" using given "value" using colormap "cmap". 
% If "cmap" is not given, the MATLAB default colormap will be used.
%
% cmap options:  "rwb" : red-white-blue
%                       "ryw" : red-yellow-white
%
%  (C) 2008. Moo K. Chung   mkchung@wisc.edu
% Last update April 29, 2008.

if nargin < 4
    cmap='default'; 
end

coord=surf.vertices;
tri=surf.faces;

trisurf(tri,coord(:,1),coord(:,2),coord(:,3),value,'facelighting','gouraud');

view(0,0); 
daspect([1 1 1]);
axis off
grid off
%camlight headlight; 

if (fig_finish == 1)
    material shiny;
elseif (fig_finish == 2)
    material dull;
else
    material([0.7 0.5 0.2]) 
end

shading interp;
background='white';
whitebg(gcf,background);
set(gcf,'Color',background,'InvertHardcopy','off');


alpha(1)

%red-white-blue
rwb=[ 0         0    1.0000
    0.0512    0.0565    1.0000
    0.1024    0.1131    1.0000
    0.1536    0.1696    1.0000
    0.2048    0.2261    1.0000
    0.2560    0.2826    1.0000
    0.3072    0.3392    1.0000
    0.3584    0.3957    1.0000
    0.4096    0.4522    1.0000
    0.4608    0.5087    1.0000
    0.5120    0.5653    1.0000
    0.5632    0.6218    1.0000
    0.6145    0.6783    1.0000
    0.6657    0.7348    1.0000
    0.7169    0.7914    1.0000
    0.7326    0.8030    1.0000
    0.7483    0.8146    1.0000
    0.7641    0.8261    1.0000
    0.7798    0.8377    1.0000
    0.7955    0.8493    1.0000
    0.8112    0.8609    1.0000
    0.8270    0.8725    1.0000
    0.8427    0.8841    1.0000
    0.8584    0.8957    1.0000
    0.8742    0.9073    1.0000
    0.8899    0.9189    1.0000
    0.9056    0.9305    1.0000
    0.9214    0.9420    1.0000
    0.9371    0.9536    1.0000
    0.9528    0.9652    1.0000
    0.9685    0.9768    1.0000
    0.9843    0.9884    1.0000
    1.0000    1.0000    1.0000
    1.0000    1.0000    0.9333
    1.0000    1.0000    0.8667
    1.0000    1.0000    0.8000
    1.0000    1.0000    0.7333
    1.0000    1.0000    0.6667
    1.0000    1.0000    0.6000
    1.0000    1.0000    0.5333
    1.0000    1.0000    0.4667
    1.0000    1.0000    0.4000
    1.0000    1.0000    0.3333
    1.0000    1.0000    0.2667
    1.0000    1.0000    0.2000
    1.0000    1.0000    0.1333
    1.0000    1.0000    0.0667
    1.0000    1.0000         0
    0.9904    0.9475         0
    0.9809    0.8951         0
    0.9713    0.8426         0
    0.9618    0.7902         0
    0.9522    0.7377         0
    0.9426    0.6853         0
    0.9331    0.6328         0
    0.9235    0.5804         0
    0.9140    0.5279         0
    0.9044    0.4755         0
    0.8949    0.4230         0
    0.8853    0.3706         0
    0.8757    0.3181         0
    0.8662    0.2657         0
    0.8566    0.2132         0
    0.8471    0.1608         0];

%red-yellow-white
ryw =[ 1.0000    1.0000    1.0000
    1.0000    0.9991    0.9977
    1.0000    0.9982    0.9954
    1.0000    0.9972    0.9931
    1.0000    0.9963    0.9908
    1.0000    0.9954    0.9885
    1.0000    0.9945    0.9862
    1.0000    0.9935    0.9839
    1.0000    0.9926    0.9815
    1.0000    0.9917    0.9792
    1.0000    0.9908    0.9769
    1.0000    0.9899    0.9746
    1.0000    0.9889    0.9723
    1.0000    0.9880    0.9700
    1.0000    0.9871    0.9677
    1.0000    0.9862    0.9654
    1.0000    0.9852    0.9631
    1.0000    0.9843    0.9608
    1.0000    0.9834    0.9585
    1.0000    0.9825    0.9562
    1.0000    0.9815    0.9539
    1.0000    0.9806    0.9516
    1.0000    0.9797    0.9493
    1.0000    0.9788    0.9469
    1.0000    0.9779    0.9446
    1.0000    0.9769    0.9423
    1.0000    0.9760    0.9400
    1.0000    0.9751    0.9377
    1.0000    0.9742    0.9354
    1.0000    0.9732    0.9331
    1.0000    0.9723    0.9308
    1.0000    0.9714    0.9285
    1.0000    0.9705    0.9262
    1.0000    0.9696    0.9239
    1.0000    0.9686    0.9216
    1.0000    0.9709    0.8557
    1.0000    0.9731    0.7899
    1.0000    0.9754    0.7241
    1.0000    0.9776    0.6583
    1.0000    0.9798    0.5924
    1.0000    0.9821    0.5266
    1.0000    0.9843    0.4608
    1.0000    0.9866    0.3950
    1.0000    0.9888    0.3291
    1.0000    0.9910    0.2633
    1.0000    0.9933    0.1975
    1.0000    0.9955    0.1317
    1.0000    0.9978    0.0658
    1.0000    1.0000         0
    0.9861    0.9237         0
    0.9722    0.8474         0
    0.9583    0.7711         0
    0.9444    0.6948         0
    0.9305    0.6185         0
    0.9166    0.5422         0
    0.9027    0.4660         0
    0.8888    0.3897         0
    0.8749    0.3134         0
    0.8610    0.2371         0
    0.8471    0.1608         0
    0.7686    0.1480    0.0020
    0.6902    0.1353    0.0039
    0.6118    0.1225    0.0059
    0.5333    0.1098    0.0078];
    
    switch cmap
        case 'default'
            %color_map='default';
            color_map='jet';
        case 'rwb'
            color_map=rwb;
        case 'ryw'
            color_map=ryw;
        case 'custom'
            color_map = color_map_lookup;
    end;

colormap(color_map);


%h = camlight('left');
%for i = 1:20;
% camorbit(10,0)
% camlight(h,'left')
% drawnow;
%end

end
